<div class="span6">
  <h1><%= @world.name -%></h1>
</div>

<div class="span6">
  <table class="table">

    <tr><th>ID</th><td><%= @world.id -%></td></tr>
    <tr><th>Component</th><td><%= @world.component -%></td></tr>
    <tr><th>Version</th><td><%= @world.version -%></td></tr>
    <tr><th>Runs</th><td><%= @world.runs.count -%></td></tr>
  </table>
</div>

<div class="span12">

  <!-- Nav tabs -->
  <ul class="nav nav-tabs">
    <li class="active"><a href="#runs" data-toggle="tab">Runs</a></li>
    <li><a href="#results" data-toggle="tab">Results</a></li>
    <li><a href="#compare" data-toggle="tab">Compare</a></li>

  </ul>


  <!-- Tab panes -->
  <div class="tab-content">
    <div class="tab-pane active" id="runs">

  <table class="table table-striped table-condensed">

    <thead>
    <tr>
      <th>Runs</th>
      <th>Target</th>
      <th>Status</th>
      <th>Duration</th>
      <th>Finished</th>
    </tr>

    </thead>

  <% @runs.each do |r| %>

    <tr>
      <td><%= link_to r.id, "/runs/#{r.id}" -%></td>
      <td><%= r.target -%></td>
      <td><%= status_badge(r.status) -%></td>
      <td><%= r.duration -%></td>
      <td><%= r.finished_at -%></td>
    </tr>

  <% end %>
  </table>

  </div>

  <div class="tab-pane" id="results">

  <table class="table table-condensed">

    <tr>
      <th colspan="2">Test</th>
      <th>Target</th>
      <th></th>
      <th>Result</th>
      <th>
        <span class="badge badge-success badge-result">P</span>
        <span class="badge badge-important badge-result">F</span>
        <span class="badge badge-inverse badge-result">N</span>
        <span class="badge badge-total badge-result">E</span>
      </th>
    </tr>

    <% @aggregate_results.each do |r| %>
        <tr class="info">
          <td colspan="2"><strong><%=  pretty_truncate(r.test_definition.name, 80, 'strong') -%></strong></td>

          <td><%= r.target -%></td>

          <td><%= r.results.count %></td>
          <td>
            <span class="result result-<%= r.status -%>"><%= r.status -%></span>
          </td>
          <td>
            <span class="badge badge-result badge-success badge-count-<%= r.best.count(:pass) -%>"><%= r.best.count(:pass) %></span>
            <span class="badge badge-result badge-important badge-count-<%= r.best.count(:fail) -%>"><%= r.best.count(:fail) or 0 %></span>
            <span class="badge badge-result badge-default badge-count-<%= r.best.count(:notrun) -%>"><%= r.best.count(:notrun) %></span>
            <span class="badge badge-result badge-inverse badge-count-<%= r.best.count(:error) -%>"><%= r.best.count(:error) -%></span>
          </td>
        </tr>

        <% r.children.each do |s| %>

            <tr>
              <td></td><td><em><%=  pretty_truncate(s.test_definition.name, 80, 'em') -%></em></td>
              <td><%= r.target -%></td>

              <td><%= s.results.count %></td>

              <td>
                <span class="result result-<%= s.status -%>"><%= s.status -%></span>
              </td>

              <td>
                <span class="badge badge-result badge-success badge-count-<%= s.best.count(:pass) -%>"><%= s.best.count(:pass) %></span>
                <span class="badge badge-result badge-important badge-count-<%= s.best.count(:fail) -%>"><%= s.best.count(:fail) or 0 %></span>
                <span class="badge badge-result badge-default badge-count-<%= s.best.count(:notrun) -%>"><%= s.best.count(:notrun) %></span>
                <span class="badge badge-result badge-inverse badge-count-<%= s.best.count(:error) -%>"><%= s.best.count(:error) -%></span>
              </td>
            </tr>

        <% end %>

    <% end %>


  </table>
</div>

    <div class="tab-pane" id="compare">

      <code>Not implemented</code>


    </div>

</div>